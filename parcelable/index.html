<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=description content="Implementing the Parcelable interface in Scala"><meta name=keywords content="Scala on Android, Scala, Android, documentation, tutorial, development, Parcelable, interface, serialization, serializable, creator, static"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no"><title>Scala on Android</title><link rel=stylesheet type=text/css media=screen href=/asset/stylesheet/agate.css><link rel=stylesheet type=text/css media=screen href=/asset/stylesheet/main.css><link rel=icon href=/asset/image/favicon.png><link rel=manifest href=/manifest.json><meta property=og:title content="Scala on Android"><meta property=og:description content="Implementing the Parcelable interface in Scala"><meta property=og:type content=website><meta property=og:url content=http://scala-on-android.taig.io/parcelable><meta property=og:image content=http://scala-on-android.taig.io/asset/image/scala-android-icon.svg><meta name=twitter:card content=summary><meta name=twitter:title content="Scala on Android"><meta name=twitter:description content="Implementing the Parcelable interface in Scala"><meta name=twitter:image content=http://scala-on-android.taig.io/asset/image/scala-android-icon.svg></head><body><header><div id=title><a href="/"><h1><strong>Scala</strong> on <strong>Android</strong></h1><h2>The comprehensive documentation</h2></a></div><nav><a href="/"><span>Table of contents</span></a><div class=shadow><div class=wrapper><ol><li><a href=/introduction>Introduction</a></li><li><a href=/about>About this documentation</a></li><li><a href=/prerequisites>Prerequisites</a></li><li><a href=/build-tool>Build Tool</a><ol><li><a href=/build-tool/sbt><em>Scala Build Tool (<abbr>sbt</abbr>)</em></a></li></ol></li><li><a href=/project-setup>Project setup</a></li><li><a href=/editor>Editors and <abbr title="Integrated Development Environment">IDE</abbr>s</a><ol><li><a href=/editor/intellij-idea><em>IntelliJ IDEA</em></a></li><li><a href=/editor/android-studio><em>Android Studio</em></a></li></ol></li><li><a href=/command-line>Working with the command line</a></li><li><a href=/dependencies>Dependencies</a></li><li><a href=/proguard><em>ProGuard</em></a><ol><li><a href=/proguard/cache>Cache</a></li></ol></li><li><a href=/typed-resources><em>Typed Resources (<abbr>TR</abbr>)</em></a></li><li class=active><a href=/parcelable><em>Parcelable</em></a></li><li><a href=/testing>Testing</a><ol><li><a href=/testing/robolectric><em>Robolectric</em></a></li></ol></li><li><a href=/library-project>Library projects</a></li><li><a href=/publishing>Publishing</a></li></ol></div></div></nav></header><main id=parcelable><section><div class="meta level-1"><button><span>Details</span></button><div class=wrapper><ul><li><span class=label>Information reliability</span> <span class=reliability><strong>Sustainable</strong> <em>Won't become outdated</em></span></li><li><span class=edit>Last edit</span> <span class=date>Wed Jun 24 17:48:48 2015 +0200</span></li><li><a href=https://github.com/taig/scala-on-android/edit/master/src/main/page/parcelable/introduction.html target=_blank>Edit on <em>GitHub</em></a></li></ul></div></div><h2><em>Parcelable</em></h2><p>You are discouraged to use the <em>Java</em> serialization framework on the <em>Android</em> platform for performance reasons. Instead, <em>Android</em> comes with its own serialization tool: <em>Parcelable</em>. A <em>Parcelable</em> class requires you to implement the <code class=inline data-language="">Parcelable</code> interface and also to fulfill a certain contract as show below.</p><pre class=code><code class=highlight><span class=hljs-keyword>import</span> android.os.Parcel;
<span class=hljs-keyword>import</span> android.os.Parcelable;

<span class=hljs-keyword>public</span> <span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>User</span> <span class=hljs-keyword>implements</span> <span class=hljs-title>Parcelable</span>
</span>{
    <span class=hljs-keyword>private</span> <span class=hljs-keyword>int</span> age;

    <span class=hljs-keyword>private</span> String name;

    <span class=hljs-comment>// Getters and Setters [...]</span>

    <span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-title>User</span><span class=hljs-params>( <span class=hljs-keyword>int</span> age, String name )</span> </span>{
        <span class=hljs-keyword>this</span>.age = age;
        <span class=hljs-keyword>this</span>.name = name;
    }

    <span class=hljs-function><span class=hljs-keyword>protected</span> <span class=hljs-title>User</span><span class=hljs-params>( Parcel source )</span> </span>{
        <span class=hljs-keyword>this</span>( source.readInt(), source.readString() )
    }

    <span class=hljs-annotation>@Override</span>
    <span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>int</span> <span class=hljs-title>describeContents</span><span class=hljs-params>()</span> </span>{ <span class=hljs-keyword>return</span> <span class=hljs-number>0</span>; }

    <span class=hljs-annotation>@Override</span>
    <span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class=hljs-title>writeToParcel</span><span class=hljs-params>( Parcel destination, <span class=hljs-keyword>int</span> flags )</span> </span>{
        destination.writeInt( age );
        destination.writeString( name );
    }

    <span class=hljs-comment>// Implemented by contract, if this field is not around you will encounter runtime</span>
    <span class=hljs-comment>// exceptions</span>
    <span class=hljs-keyword>public</span> <span class=hljs-keyword>static</span> <span class=hljs-keyword>final</span> Parcelable.Creator&lt;User&gt; CREATOR = <span class=hljs-keyword>new</span> Parcelable.Creator&lt;User&gt;() {
        <span class=hljs-function><span class=hljs-keyword>public</span> User <span class=hljs-title>createFromParcel</span><span class=hljs-params>( Parcel source )</span> </span>{ <span class=hljs-keyword>return</span> <span class=hljs-keyword>new</span> User( source ); }

        <span class=hljs-keyword>public</span> User[] newArray( <span class=hljs-keyword>int</span> size ) { <span class=hljs-keyword>return</span> <span class=hljs-keyword>new</span> User[size]; }
    };
}</code></pre><p>A <em>Parcelable</em> class forces you to implement a lot of boilerplate code, but offers great performance as it does not rely on runtime reflection like the default <em>Java</em> serialization framework. But when it comes to <em>Scala on Android</em> there emerges another problem: the <em>Parcelable</em> contract requires a static class member. This is impossible in <em>Scala</em> because there is no support for statics.</p><p>Luckily, the <em>Scala</em> compiler checks for the <em>Android</em> <code class=inline data-language="">Parcelable</code> interface and treats it in a special way to support <em>Android</em> development. At the end of the day there is just another contract to implement that relies on the class' companion to overcome the lack of statics. Below is a valid <em>Scala</em> implementation of the previous example.</p><pre class=code><code class=highlight><span class=hljs-keyword>import</span> android.os.{ <span class=hljs-type>Parcel</span>, <span class=hljs-type>Parcelable</span> }

<span class=hljs-keyword>case</span> <span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>User</span>(</span> age: <span class=hljs-type>Int</span>, name: <span class=hljs-type>String</span> ) <span class=hljs-keyword>extends</span> <span class=hljs-type>Parcelable</span> {
    <span class=hljs-keyword>protected</span> <span class=hljs-keyword>this</span>( source: <span class=hljs-type>Parcel</span> ) = <span class=hljs-keyword>this</span>( source.readInt(), source.readString() )

    <span class=hljs-keyword>override</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>describeContents</span>(</span>) = <span class=hljs-number>0</span>

    <span class=hljs-keyword>override</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>writeToParcel</span>(</span> destination: <span class=hljs-type>Parcel</span>, flags: <span class=hljs-type>Int</span> ) {
        destination.writeInt( age )
        destination.writeString( name )
    }
}

<span class=hljs-class><span class=hljs-keyword>object</span> <span class=hljs-title>User</span>
</span>{
    <span class=hljs-comment>// This is by contract, the CREATOR field must exist for every class that implements</span>
    <span class=hljs-comment>// the Parcelable interface.</span>
    <span class=hljs-keyword>override</span> <span class=hljs-keyword>val</span> <span class=hljs-type>CREATOR</span> = <span class=hljs-keyword>new</span> <span class=hljs-type>Parcelable</span>.<span class=hljs-type>Creator</span>[<span class=hljs-type>User</span>] {
        <span class=hljs-keyword>override</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>createFromParcel</span>(</span> source: <span class=hljs-type>Parcel</span> ) = <span class=hljs-keyword>new</span> <span class=hljs-type>User</span>( source )

        <span class=hljs-keyword>override</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>newArray</span>(</span> size: <span class=hljs-type>Int</span> ) = <span class=hljs-keyword>new</span> <span class=hljs-type>Array</span>[<span class=hljs-type>User</span>]( size )
    }
}</code></pre></section><section><div class="meta level-2"><button><span>Details</span></button><div class=wrapper><ul><li><span class=label>Information reliability</span> <span class=reliability><strong>Moderate</strong> <em>Might become outdated</em></span></li><li><span class=edit>Last edit</span> <span class=date>Tue Jun 9 15:46:52 2015 +0200</span></li><li><a href=https://github.com/taig/scala-on-android/edit/master/src/main/page/parcelable/alternatives.html target=_blank>Edit on <em>GitHub</em></a></li></ul></div></div><h2>Alternatives</h2><p><em>Scala</em> comes with first class macro support (compile time reflection). This allows for code generation at compile time that may help to reduce boilerplate in use cases like this without sacrificing performance. To simplify <em>Inter Process Communication (<abbr>IPC</abbr>)</em> with the <em>Parcelable</em> contract, you could instead try one of the numerous <em>JavaScript Object Notation</em> libraries, or <a href="http://lampwww.epfl.ch/~hmiller/pickling/" title="Scala serialization project" target=_blank><em>Scala Pickling</em></a>, a project that aims to bring boilerplate-free serialization to <em>Scala</em>.</p></section><section data-src=sources.js data-level=0><h3>Further reading</h3><ul class=further-reading><li><a href="http://www.developerphil.com/parcelable-vs-serializable/" target=_blank><em>Parcelable</em> vs. <em>Serializable</em></a><p>A performance and usability comparison</p></li><li><a href="http://lampwww.epfl.ch/~hmiller/pickling/" target=_blank><em>Scala Pickling</em></a><p><em>Scala</em> serialization project</p></li><li><a href="https://github.com/taig/parcelable/" target=_blank><em>Parcelable</em></a><p>Compile time code generation for <em>Scala on Android</em></p></li></ul></section><section><h3>Comments</h3><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname="scala-on-android",disqus_identifier="parcelable",disqus_title="Scala on Android";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></section></main><footer><div class=story><div class=back><a href=/typed-resources><em>Typed Resources (<abbr>TR</abbr>)</em></a></div><div class=continue><a href=/testing>Testing</a></div></div><div class=fixtures><div class=left><ul><li><a href="https://github.com/taig/scala-on-android/" title="Scala on Android" target=_blank>Fork me on <em>GitHub</em></a></li><li><a href=/help>Getting help</a></li></ul></div><div class=center><img src=/asset/image/scala-android-logo.svg alt="Scala on Android logo"> <span class=version>Version 1.0.6</span></div><div class=right><ul><li><a href=/sources>Sources</a></li><li><a href=/software>Software</a></li><li><a href=/abbreviations>Abbreviations</a></li></ul></div></div></footer><script data-main=/asset/javascript/main src=/asset/javascript/require-2.1.17.min.js></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-64109905-1","auto"),ga("send","pageview");</script><script type=application/ld+json>{
	"@context" : "http://schema.org",
	"@type" : "WebSite",
	"name" : "Scala on Android",
	"url" : "http://scala-on-android.taig.io/"
}</script><script type=application/ld+json>{
	"@context": "http://schema.org",
	"@type": "BreadcrumbList",
	"itemListElement":
	[
		
		{
			"@type": "ListItem",
			"position": 1,
			"item":
			{
				"@id": "/parcelable",
				"name": "Parcelable"
			}
		}
		
	]
}</script></body></html>